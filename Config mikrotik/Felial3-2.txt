system identity set name=Felial3-2
ether1 is 192.168.3.3/24
ether2 is dhcp client
vrrp1 is 192.168.3.1/24
gre-tunnellF1 132.1.132.2/30; via 200.1.1.254
gre-tunnellF2 110.1.110.2/30; via 200.1.2.254
gre-tunnellF1-2 125.1.125.1/30; via 200.1.11.254
gre-tunnellF2-2 115.1.115.1/30; via 200.1.22.254
ip route 192.168.1.0/24 via 132.1.132.1 || F1
ip route 192.168.1.0/24 via 125.1.125.1 || F1-2
ip route 10.1.1.0/24 via 110.1.110.1 || F2
ip route 10.1.1.0/24 via 115.1.115.1 || F2-2
vrrp on ether1; no preemption; 50 priority; version 2; au ah passwrd "3232"
dhcp server "server1" on vrrp1 with address pool "pool1"; dns 192.168.3.1
dhcp network 192.168.3.0/24 gateway 192.168.3.1
dhcp pool "pool1" 192.168.3.4-192.168.3.254
dns dynamic dns by ether2
NAT add srcnat with out ether2 in action masquerad
NAT add srcnat with out gre-tunnellF1 in action masquerad
NAT add srcnat with out gre-tunnellF1-2 in action masquerad
NAT add srcnat with out gre-tunnellF2 in action masquerad
NAT add srcnat with out gre-tunnelF2-2 in action masquerad
netwatch {
"F1" 200.1.1.254 simple
if up (/ip/route enable [find comment="F1"]  /ip/route disable [find comment="F1-2"])
if down (/ip/route enable [find comment="F1-2"]  /ip/route disable [find comment="F1"])
}
netwatch {
"F2" 200.1.2.254 simple
if up (/ip/route enable [find comment="F2"]  /ip/route disable [find comment="F2-2"])
if down (/ip/route enable [find comment="F2-2"]  /ip/route disable [find comment="F2"])
}